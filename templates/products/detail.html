{% extends 'base.html' %}
{% block page_title %}{{ product.name }}{% endblock %}
{% block meta_description %}Shop {{ product.name }} â€“ {{ product.description|truncatechars:150 }}{% endblock %}

{% block content %}
  <div class="row g-4">
    <!-- Product image -->
    <div class="col-md-6">
      <div class="product-detail-image-wrapper mb-3">
        <img
          src="{{ product.image_url }}"
          alt="{{ product.name }}"
          class="img-fluid product-detail-image"
        />
      </div>
    </div>

    <!-- Product info + actions -->
    <div class="col-md-6">
      <h1 class="mb-2">{{ product.name }}</h1>
      <p class="h5 mb-3">R{{ product.price }}</p>
      <p class="mb-4">{{ product.description }}</p>

      <!-- Quantity + Add to Cart + Wishlist (stacked) -->
      <div class="product-detail-actions mb-4">
        <form method="post" action="{% url 'checkout:cart_add' product.id %}" class="mb-3">
          {% csrf_token %}
          <label for="id_quantity" class="form-label d-block mb-2">Quantity</label>
          <input
            type="number"
            id="id_quantity"
            name="quantity"
            value="1"
            min="1"
            class="form-control mb-3"
            style="max-width: 220px;"
          />
          <button type="submit" class="btn btn-success w-100 mb-3">
            Add to Cart
          </button>
        </form>

        {% if user.is_authenticated %}
          <a
            class="btn btn-outline-secondary w-100"
            href="{% url 'accounts:wishlist_add' product.id %}"
          >
            Add to Wishlist
          </a>
        {% else %}
          <p class="mt-2">
            <small class="text-muted">
              <a href="/accounts/login/">Log in</a> to add this candle to your wishlist.
            </small>
          </p>
        {% endif %}
      </div>

      <hr class="my-4">

      <!-- Simple Reviews section (no broken URL) -->
      <h2 class="h5 mb-3">Reviews</h2>
      <p class="text-muted mb-0">
        Reviews feature coming soon. For now, you can contact us via the
        <a href="{% url 'marketing:contact' %}">contact page</a> if you have feedback about this scent.
      </p>
    </div>
  </div>
{% endblock %}
